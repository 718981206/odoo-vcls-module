<odoo>
<template id="report_invoice_activities_document">
    <t t-call="web.external_layout">
        <t t-set="o" t-value="o.with_context(lang=o.partner_id.lang)"/>
        <div class="page">
            <div class="oe_structure"/>
            <h2><span t-field="o.number"/></h2>
            <table class="table table-sm">
                <thead>
                    <th>Project</th>
                    <th>Deliverable</th>
                    <th>Task</th>
                    <th>Time category</th>
                    <th>Product</th>
                    <th>Amount</th>
                </thead>
                <tbody>
                    <tr t-foreach="o.timesheet_ids.sorted(lambda t:(t.project_id,t.task_id.sale_line_id.product_id.deliverable_id,t.task_id))" t-as="timesheet_id">
                        <td>
                            <span t-field="timesheet_id.project_id.name"/>
                        </td>
                        <td>
                            <span t-field="timesheet_id.task_id.sale_line_id.product_id.deliverable_id.name"/>
                        </td>
                        <td>
                            <span t-field="timesheet_id.task_id.name"/>
                        </td>
                        <td>
                            <span t-field="timesheet_id.time_category_id.name"/>
                        </td>
                        <td>
                            <span t-field="timesheet_id.task_id.sale_line_id.product_id.name"/>
                        </td>
                        <td>
                            <span t-field="timesheet_id.unit_amount"/>
                        </td>
                    </tr>
                </tbody>
            </table>
            <div class="oe_structure"/>
        </div>
    </t>
</template>

<template id="report_invoice_activities">
    <t t-call="web.html_container">
        <t t-foreach="docs" t-as="o">
            <t t-call="vcls-invoicing.report_invoice_activities_document" t-lang="o.partner_id.lang"/>
        </t>
    </t>
</template>

<report id="invoice_activities_report"
        model="account.invoice"
        string="Activity report"
        file="Activity report"
        report_type="qweb-pdf"
        name="vcls-invoicing.report_invoice_activities"
/>

</odoo>
